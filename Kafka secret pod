Perfect ‚úÖ ‚Äî let‚Äôs go step-by-step on how to create a Kubernetes Secret for your Kafka truststore.jks and its password, then how to refer it inside your Spring Boot pod config and application.properties.


---

üß© Step 1: Create the Kubernetes Secret

Suppose you have:

Truststore file: /home/user/truststore.jks

Truststore password: trust123


Run:

kubectl create secret generic kafka-truststore-secret \
  --from-file=truststore.jks=/home/user/truststore.jks \
  --from-literal=truststore-password=trust123

You can check it:

kubectl get secret kafka-truststore-secret -o yaml


---

‚öôÔ∏è Step 2: Mount the secret in your Pod / Deployment YAML

In your Deployment (or StatefulSet) manifest:

apiVersion: apps/v1
kind: Deployment
metadata:
  name: spring-kafka-app
spec:
  replicas: 1
  selector:
    matchLabels:
      app: spring-kafka-app
  template:
    metadata:
      labels:
        app: spring-kafka-app
    spec:
      containers:
        - name: spring-kafka-app
          image: your-springboot-image:latest
          volumeMounts:
            - name: kafka-truststore
              mountPath: /etc/kafka/secrets
              readOnly: true
          env:
            - name: TRUSTSTORE_PASSWORD
              valueFrom:
                secretKeyRef:
                  name: kafka-truststore-secret
                  key: truststore-password
      volumes:
        - name: kafka-truststore
          secret:
            secretName: kafka-truststore-secret


---

üß† Step 3: Reference it inside Spring Boot configuration

In your application.properties (or application.yml):

spring.kafka.properties.security.protocol=SASL_SSL
spring.kafka.properties.ssl.truststore.location=/etc/kafka/secrets/truststore.jks
spring.kafka.properties.ssl.truststore.password=${TRUSTSTORE_PASSWORD}
spring.kafka.properties.sasl.mechanism=SCRAM-SHA-512
spring.kafka.properties.sasl.jaas.config=org.apache.kafka.common.security.scram.ScramLoginModule required username="user" password="pass";

The key part:

The truststore.jks file is read from the mounted path /etc/kafka/secrets

The truststore password is injected from the Kubernetes secret using ${TRUSTSTORE_PASSWORD}



---

‚úÖ Step 4: Verify

You can test inside your pod:

kubectl exec -it <pod-name> -- ls /etc/kafka/secrets

You should see:

truststore.jks

And ensure the environment variable is loaded:

kubectl exec -it <pod-name> -- printenv | grep TRUSTSTORE_PASSWORD


---

Would you also like me to include keystore.jks and its password in the same secret (for mutual TLS)?
That‚Äôs common if your Kafka requires client certificate authentication (SASL_SSL + SSL).

